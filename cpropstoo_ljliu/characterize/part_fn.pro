function part_fn, t_rot, mol, approx=approx

  kb = 1.380658d-16             ; Boltzmann's const CGS
  h = 6.6260755e-27             ; Planck CGS

  if mol eq '12co' then begin
     e = [0, $
          5.53, $
          16.60, $
          33.19, $
          55.32, $
          82.97, $
          116.16, $
          154.87, $
          199.11, $
          248.88, $
          304.16, $
          364.97, $
          431.29, $
          503.13, $
          580.49, $
          663.35, $
          751.72, $
          845.59, $
          944.97, $
          1049.84, $
          1160.20, $
          1276.05, $
          1397.38, $
          1524.19, $
          1656.47, $
          1794.23, $
          1937.44, $
          2086.12, $
          2240.24, $
          2399.82, $
          2564.83, $
          2735.28, $
          2911.15, $
          3092.45, $
          3279.15, $
          3471.27, $
          3668.78, $
          3871.69, $
          4079.98, $
          4293.64, $
          4512.67 $ 
         ]
         B = !values.f_nan
  endif


  if mol eq '13co' then begin
     e = [0, $
          5.29, $
          15.87, $
          31.73, $
          52.89, $
          79.33, $
          111.05, $
          148.06, $
          190.36, $
          237.93, $
          290.79, $
          348.92, $
          412.33, $
          481.02, $
          554.97, $
          634.20, $
          718.69, $
          808.44, $
          903.45, $
          1003.72, $
          1109.24, $
          1220.00, $
          1336.01, $
          1457.27, $
          1583.75, $
          1715.47, $
          1852.42, $
          1994.58, $
          2141.96, $
          2294.55, $
          2452.35, $
          2615.35, $
          2783.54, $
          2956.91, $
          3135.47, $
          3319.20, $
          3508.10, $
          3702.16, $
          3901.37, $
          4105.73, $
          4315.23 $
         ]
     B = 55101.01
  endif
  
  if mol eq 'h13cn' then begin
     e = [0, $
          4.14, $
          12.43, $
          24.86, $
          41.43, $
          62.15, $
          87.01, $
          116.01, $
          149.15, $
          186.43, $
          227.85, $
          273.41, $
          323.11, $
          376.94, $
          434.91, $
          497.01, $
          563.24, $
          633.61, $
          708.10, $
          786.72, $
          869.46, $
          956.33, $
          1047.32, $
          1142.43, $
          1241.66, $
          1345.00, $ 
          1452.46, $
          1564.02, $
          1679.70, $
          1799.48 $
         ]
     b = 43170.13
  endif

  if mol eq 'h13cop' then begin
     e = [0, $
          4.16, $
          12.49, $
          24.98, $
          41.63, $
          62.45, $
          87.43, $
          116.57, $
          149.87, $
          187.33, $
          228.95, $
          274.73, $
          324.66, $
          378.76, $
          437.01, $
          499.41, $
          565.96, $
          636.67, $
          711.52, $
          790.53, $
          873.68, $
          960.97, $
          1052.41, $
          1147.99, $
          1247.71, $
          1351.56, $
          1459.55, $
          1571.67, $
          1687.91, $
          1808.29, $
          1932.79 $
         ]     
     b = 44594.43
  endif

  if mol eq 'c17o' then begin
     e = [0, $
          5.39, $
          16.18, $
          32.35, $
          53.92, $
          80.88, $
          113.23, $
          150.96, $
          194.08, $
          242.59, $
          296.48, $
          355.75, $
          420.40, $
          490.43, $
          565.83, $
          646.61, $
          732.75, $
          824.25, $
          921.12, $
          1023.35, $
          1130.93, $
          1243.86, $
          1362.13, $
          1485.75, $
          1614.71, $
          1748.99, $
          1888.61, $
          2033.55, $
          2183.80, $
          2339.36, $
          2500.23, $
          2666.40, $
          2837.86, $
          3014.61, $
          3196.64, $
          3383.94, $
          3576.51, $
          3774.33, $
          3977.41, $
          4185.73, $
          4399.29]
  endif

  if mol eq 'c18o' then begin
     e = [0, $
          5.27, $
          15.81, $
          31.61, $
          52.68, $
          79.02, $
          110.63, $
          147.50, $
          189.63, $
          237.03, $
          289.68, $
          347.60, $
          410.77, $
          479.19, $
          552.86, $
          631.79, $
          715.95, $
          805.36, $
          900.02, $
          999.90, $
          1105.02, $
          1215.37, $
          1330.94, $
          1451.73, $
          1577.74, $
          1708.96, $
          1845.38, $
          1987.01, $
          2133.83, $
          2285.85, $
          2443.05, $
          2605.43, $
          2772.98, $
          2945.70, $
          3123.58, $
          3306.62, $
          3494.81, $
          3688.13, $
          3886.60, $
          4090.18, $
          4298.89 $
         ]
  endif


  if keyword_set(approx) then begin
     if n_elements(b) gt 0 then begin
        q = kb*t_rot/h/b/1d6 + 1./3.
                                ;q = 2.0*t_rot/e[1]
     endif
     return, q
  endif

  n_lev = n_elements(e)
  q = 0.0d
  for j = 0, n_lev-1 do begin
     q += (2.*j+1.0)*exp(-e[j]/t_rot)
  endfor

  return, q

end
